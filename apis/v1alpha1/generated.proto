/*
Copyright 2019 The Pharmer Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


// This file was autogenerated by go-to-protobuf. Do not edit it manually!

syntax = 'proto2';

package github.com.pharmer.pharmer.apis.v1alpha1;

import "k8s.io/api/core/v1/generated.proto";
import "k8s.io/apimachinery/pkg/apis/meta/v1/generated.proto";

// Package-wide variables from generator "generated".
option go_package = "v1alpha1";

message API {
  // AdvertiseAddress sets the address for the API server to advertise.
  optional string advertiseAddress = 1;

  // BindPort sets the secure port for the API Server to bind to
  optional int32 bindPort = 2;
}

message AWSSpec {
  // aws:TAG KubernetesCluster => clusterid
  optional string iamProfileMaster = 1;

  optional string iamProfileNode = 2;

  optional string masterSGName = 3;

  optional string nodeSGName = 4;

  optional string vpcCIDR = 5;

  optional string vpcCIDRBase = 6;

  optional string masterIPSuffix = 7;

  optional string subnetCidr = 8;
}

message AWSStatus {
  optional string masterSGID = 1;

  optional string nodeSGID = 2;

  optional string vpcID = 3;

  optional string subnetID = 4;

  optional string routeTableID = 5;

  optional string igwID = 6;

  optional string dhcpOptionsID = 7;

  optional string volumeID = 8;
}

message Action {
  optional string action = 1;

  optional string resource = 2;

  optional string message = 3;
}

// ref: https://github.com/kubernetes/kubernetes/blob/8b9f0ea5de2083589f3b9b289b90273556bc09c4/pkg/cloudprovider/providers/azure/azure.go#L56
message AzureCloudConfig {
  optional string tenantId = 1;

  optional string subscriptionId = 2;

  optional string aadClientId = 3;

  optional string aadClientSecret = 4;

  optional string resourceGroup = 5;

  optional string location = 6;

  optional string subnetName = 7;

  optional string securityGroupName = 8;

  optional string vnetName = 9;

  optional string routeTableName = 10;

  optional string storageAccountName = 11;
}

message AzureSpec {
  optional string instanceImageVersion = 1;

  optional string rootPassword = 2;

  optional string subnetCidr = 3;

  optional string resourceGroup = 4;

  optional string subnetName = 5;

  optional string securityGroupName = 6;

  optional string vnetName = 7;

  optional string routeTableName = 8;

  optional string azureStorageAccountName = 9;
}

message AzureStorageSpec {
  optional string container = 1;

  optional string prefix = 2;
}

message CloudSpec {
  optional string cloudProvider = 1;

  optional string project = 2;

  optional string region = 3;

  optional string zone = 4;

  // master needs it for ossec
  optional string instanceImage = 5;

  optional string os = 6;

  optional string instanceImageProject = 7;

  optional string ccmCredentialName = 8;

  optional string sshKeyName = 9;

  optional AWSSpec aws = 10;

  optional GoogleSpec gce = 11;

  optional AzureSpec azure = 12;

  optional LinodeSpec linode = 13;

  optional GKESpec gke = 14;
}

message CloudStatus {
  optional string sshKeyExternalID = 1;

  optional AWSStatus aws = 2;

  optional EKSStatus eks = 3;
}

message Cluster {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ClusterSpec spec = 2;

  optional ClusterStatus status = 3;
}

message ClusterSpec {
  optional CloudSpec cloud = 1;

  optional API api = 2;

  optional Networking networking = 3;

  optional string kubernetesVersion = 4;

  optional bool locked = 5;

  optional string caCertName = 6;

  optional string frontProxyCACertName = 7;

  optional string credentialName = 8;

  map<string, string> kubeletExtraArgs = 9;

  map<string, string> apiServerExtraArgs = 10;

  map<string, string> controllerManagerExtraArgs = 11;

  map<string, string> schedulerExtraArgs = 12;

  repeated string authorizationModes = 13;

  repeated string apiServerCertSANs = 14;
}

// ClusterState describes the state of certain versions for a cluster
message ClusterState {
  // KubeVersion describes the version of the Kubernetes API Server, Controller Manager, Scheduler and Proxy.
  optional string kubeVersion = 1;

  // DNSType
  optional string dnsType = 2;

  // DNSVersion describes the version of the kube-dns images used and manifest version
  optional string dnsVersion = 3;

  // MasterKubeadmVersion describes the version of the kubeadm CLI
  optional string kubeadmVersion = 4;

  // KubeletVersions is a map with a version number linked to the amount of kubelets running that version in the cluster
  map<string, uint32> kubeletVersions = 5;
}

message ClusterStatus {
  optional string phase = 1;

  optional string reason = 2;

  optional CloudStatus cloud = 4;

  repeated k8s.io.api.core.v1.NodeAddress apiServer = 5;

  repeated ReservedIP reservedIP = 6;
}

message Credential {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional CredentialSpec spec = 2;
}

message CredentialSpec {
  optional string provider = 1;

  map<string, string> data = 2;
}

message EKSStatus {
  optional string securityGroup = 1;

  optional string vpcID = 2;

  optional string subnetID = 3;

  optional string roleArn = 4;
}

// ExecConfig specifies a command to provide client credentials. The command is exec'd
// and outputs structured stdout holding credentials.
// 
// See the client.authentiction.k8s.io API group for specifications of the exact input
// and output format
message ExecConfig {
  // Command to execute.
  optional string command = 1;

  // Arguments to pass to the command when executing it.
  // +optional
  repeated string args = 2;

  // Env defines additional environment variables to expose to the process. These
  // are unioned with the host's environment, as well as variables client-go uses
  // to pass argument to the plugin.
  // +optional
  repeated ExecEnvVar env = 3;

  // Preferred input version of the ExecInfo. The returned ExecCredentials MUST use
  // the same encoding version as the input.
  optional string apiVersion = 4;
}

// ExecEnvVar is used for setting environment variables when executing an exec-based
// credential plugin.
message ExecEnvVar {
  optional string name = 1;

  optional string value = 2;
}

// ref: https://github.com/kubernetes/kubernetes/blob/8b9f0ea5de2083589f3b9b289b90273556bc09c4/pkg/cloudprovider/providers/gce/gce.go#L228
message GCECloudConfig {
  optional string tokenURL = 1;

  optional string tokenBody = 2;

  optional string projectID = 3;

  optional string networkName = 4;

  repeated string nodeTags = 5;

  optional string nodeInstancePrefix = 6;

  optional bool multizone = 7;
}

message GCSSpec {
  optional string bucket = 1;

  optional string prefix = 2;
}

message GKESpec {
  optional string userName = 1;

  optional string password = 2;

  optional string networkName = 3;
}

message GoogleSpec {
  optional string networkName = 1;

  repeated string nodeTags = 2;

  // gce
  // NODE_SCOPES="${NODE_SCOPES:-compute-rw,monitoring,logging-write,storage-ro}"
  repeated string nodeScopes = 3;
}

// Config holds the information needed to build connect to remote kubernetes clusters as a given user
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
message KubeConfig {
  // Preferences holds general information to be use for cli interactions
  optional Preferences preferences = 1;

  // Clusters is a map of referencable names to cluster configs
  optional NamedCluster cluster = 2;

  // AuthInfos is a map of referencable names to user configs
  optional NamedAuthInfo user = 3;

  // Contexts is a map of referencable names to context configs
  optional NamedContext context = 4;
}

message LightsailCloudConfig {
  optional string accessKeyID = 1;

  optional string secretAccessKey = 2;
}

message LinodeCloudConfig {
  optional string token = 1;

  optional string zone = 2;
}

message LinodeSpec {
  // Linode
  optional string rootPassword = 1;
}

message LocalSpec {
  optional string path = 1;
}

// NamedAuthInfo relates nicknames to auth information
message NamedAuthInfo {
  // Name is the nickname for this AuthInfo
  optional string name = 1;

  // ClientCertificateData contains PEM-encoded data from a client cert file for TLS.
  // +optional
  optional bytes clientCertificateData = 2;

  // ClientKeyData contains PEM-encoded data from a client key file for TLS.
  // +optional
  optional bytes clientKeyData = 3;

  // Token is the bearer token for authentication to the kubernetes cluster.
  // +optional
  optional string token = 4;

  // Username is the username for basic authentication to the kubernetes cluster.
  // +optional
  optional string username = 5;

  // Password is the password for basic authentication to the kubernetes cluster.
  // +optional
  optional string password = 6;

  // +optional
  optional ExecConfig exec = 7;
}

// NamedCluster relates nicknames to cluster information
message NamedCluster {
  // Name is the nickname for this Cluster
  optional string name = 1;

  // Server is the address of the kubernetes cluster (https://hostname:port).
  optional string server = 2;

  // CertificateAuthorityData contains PEM-encoded certificate authority certificates. Overrides CertificateAuthorityData
  // +optional
  optional bytes certificateAuthorityData = 3;
}

// NamedContext relates nicknames to context information
message NamedContext {
  // Name is the nickname for this Context
  optional string name = 1;

  // Cluster is the name of the cluster for this context
  optional string cluster = 2;

  // AuthInfo is the name of the authInfo for this context
  optional string user = 3;
}

message Networking {
  optional string networkProvider = 1;

  // kubenet, flannel, calico, opencontrail
  optional string podSubnet = 2;

  optional string serviceSubnet = 3;

  optional string dnsDomain = 4;

  // NEW
  // Replacing API_SERVERS https://github.com/kubernetes/kubernetes/blob/62898319dff291843e53b7839c6cde14ee5d2aa4/cluster/aws/util.sh#L1004
  optional string dnsServerIP = 5;

  optional string nonMasqueradeCIDR = 6;

  optional string masterSubnet = 7;
}

message NodeGroup {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional NodeGroupSpec spec = 2;

  optional NodeGroupStatus status = 3;
}

message NodeGroupSpec {
  optional int64 nodes = 1;

  // Template describes the nodes that will be created.
  optional NodeTemplateSpec template = 2;
}

// NodeGroupStatus is the most recently observed status of the NodeGroup.
message NodeGroupStatus {
  // Nodes is the most recently oberved number of nodes.
  optional int64 nodes = 1;

  // ObservedGeneration reflects the generation of the most recently observed node group.
  // +optional
  optional int64 observedGeneration = 2;
}

message NodeInfo {
  optional string name = 1;

  optional string externalID = 2;

  optional string publicIP = 3;

  optional string privateIP = 4;

  optional string diskID = 5;
}

message NodeSpec {
  optional string sku = 1;

  optional string nodeDiskType = 2;

  optional int64 nodeDiskSize = 3;

  optional string externalIPType = 4;

  map<string, string> kubeletExtraArgs = 5;

  optional string type = 6;

  optional double spotPriceMax = 7;
}

// PodTemplateSpec describes the data a pod should have when created from a template
message NodeTemplateSpec {
  // Specification of the desired behavior of the pod.
  // More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status
  // +optional
  optional NodeSpec spec = 1;
}

message NullNameGenerator {
}

message OVHCloudConfig {
  optional string authUrl = 1;

  optional string username = 2;

  optional string password = 3;

  optional string tenantId = 4;

  optional string region = 5;
}

message PacketCloudConfig {
  optional string project = 1;

  optional string apiKey = 2;

  optional string zone = 3;
}

message PharmerConfig {
  optional string context = 1;

  repeated Credential credentials = 2;

  optional StorageBackend store = 3;
}

message PostgresSpec {
  optional string dbName = 1;

  optional string host = 2;

  optional int64 port = 3;

  optional string user = 4;

  optional string password = 5;
}

message Preferences {
  // +optional
  optional bool colors = 1;
}

message ReservedIP {
  optional string ip = 1;

  optional string id = 2;

  optional string name = 3;
}

message S3Spec {
  optional string endpoint = 1;

  optional string bucket = 2;

  optional string prefix = 3;
}

message SSHConfig {
  optional bytes privateKey = 1;

  optional string hostIP = 2;

  optional int32 hostPort = 3;

  optional string user = 4;
}

message ScalewayCloudConfig {
  optional string organization = 1;

  optional string token = 2;

  optional string region = 3;
}

message SoftlayerCloudConfig {
  optional string username = 1;

  optional string apiKey = 2;

  optional string zone = 3;
}

message StorageBackend {
  optional string credentialName = 1;

  optional LocalSpec local = 2;

  optional S3Spec s3 = 3;

  optional GCSSpec gcs = 4;

  optional AzureStorageSpec azure = 5;

  optional SwiftSpec swift = 6;

  optional PostgresSpec postgres = 7;
}

message SwiftSpec {
  optional string container = 1;

  optional string prefix = 2;
}

// https://github.com/kubernetes/kubernetes/blob/aa1dc9db3532dfbf09e45c8e3786a648cd217417/cmd/kubeadm/app/phases/upgrade/compute.go#L28
message Upgrade {
  optional string description = 1;

  optional ClusterState before = 2;

  optional ClusterState after = 3;
}

message VultrCloudConfig {
  optional string token = 1;
}

